/*VRP ZAD. 3A*/
proc optmodel;
num n=21;
num n0=7;
num m=3;
num c{i in 1..n, j in 1..n}=[
0	12	31	11	23	24	12	21	8	9	30	23	27	26	20	10	2	28	16	18	26
12	0	38	5	31	35	24	24	15	15	26	34	19	19	18	19	13	16	20	21	34
31	38	0	40	9	27	23	15	39	39	61	39	37	33	23	21	29	48	47	17	6
11	5	40	0	32	34	23	26	11	11	23	31	24	23	22	20	12	19	16	24	35
23	31	9	32	0	20	15	13	31	31	54	31	34	31	20	13	21	44	39	12	3
24	35	27	34	20	0	12	29	26	26	49	13	47	44	34	19	23	51	31	27	21
12	24	23	23	15	12	0	19	18	17	41	18	35	32	23	7	11	39	25	16	17
21	24	15	26	13	29	19	0	29	29	49	37	22	18	8	13	18	33	37	3	14
8	15	39	11	31	26	18	29	0	1	23	21	33	32	28	18	11	30	8	26	33
9	15	39	11	31	26	17	29	1	0	24	21	33	32	28	18	11	30	8	26	33
30	26	61	23	54	49	41	49	23	24	0	40	43	44	45	41	33	31	18	46	56
23	34	39	31	31	13	18	37	21	21	40	0	50	48	40	24	24	50	23	34	33
27	19	37	24	34	47	35	22	33	33	43	50	0	4	14	28	26	15	39	22	35
26	19	33	23	31	44	32	18	32	32	44	48	4	0	10	25	24	18	39	19	32
20	18	23	22	20	34	23	8	28	28	45	40	14	10	0	16	18	25	35	8	22
10	19	21	20	13	19	7	13	18	18	41	24	28	25	16	0	8	34	26	10	16
2	13	29	12	21	23	11	18	11	11	33	24	26	24	18	8	0	28	19	15	24
28	16	48	19	44	51	39	33	30	30	31	50	15	18	25	34	28	0	33	32	46
16	20	47	16	39	31	25	37	8	8	18	23	39	39	35	26	19	33	0	34	41
18	21	17	24	12	27	16	3	26	26	46	34	22	19	8	10	15	32	34	0	14
26	34	6	35	3	21	17	14	33	33	56	33	35	32	22	16	24	46	41	14	0
];
var x{i in 1..n,j in 1..n} binary;
var z{i in 2..n}>=1 <=n0;
min koszt=sum{i in 1..n,j in 1..n}c[i,j]*x[i,j];
con do1Miasta{i in 2..n}: sum{j in 1..n}x[i,j]=1;
con z1Miasta{j in 2..n}: sum{i in 1..n}x[i,j]=1;
con magDoMMiast: sum{j in 1..n}x[1,j]=m;
con magZMMiast: sum{i in 1..n}x[i,1]=m;
con ogr: x[1,1]=0;
con bezKrotkichCykli{i in 2..n,j in 2..n}:
z[i]-z[j]+n0*x[i,j]<=n0-1;
solve with milp / timetype =1 maxtime = 30;
print x z;
quit;

/*VRP ZAD. 3B*/
proc optmodel;
num n=21;
num Q0=40;
num m=3;
num c{i in 1..n, j in 1..n}=[
0	12	31	11	23	24	12	21	8	9	30	23	27	26	20	10	2	28	16	18	26
12	0	38	5	31	35	24	24	15	15	26	34	19	19	18	19	13	16	20	21	34
31	38	0	40	9	27	23	15	39	39	61	39	37	33	23	21	29	48	47	17	6
11	5	40	0	32	34	23	26	11	11	23	31	24	23	22	20	12	19	16	24	35
23	31	9	32	0	20	15	13	31	31	54	31	34	31	20	13	21	44	39	12	3
24	35	27	34	20	0	12	29	26	26	49	13	47	44	34	19	23	51	31	27	21
12	24	23	23	15	12	0	19	18	17	41	18	35	32	23	7	11	39	25	16	17
21	24	15	26	13	29	19	0	29	29	49	37	22	18	8	13	18	33	37	3	14
8	15	39	11	31	26	18	29	0	1	23	21	33	32	28	18	11	30	8	26	33
9	15	39	11	31	26	17	29	1	0	24	21	33	32	28	18	11	30	8	26	33
30	26	61	23	54	49	41	49	23	24	0	40	43	44	45	41	33	31	18	46	56
23	34	39	31	31	13	18	37	21	21	40	0	50	48	40	24	24	50	23	34	33
27	19	37	24	34	47	35	22	33	33	43	50	0	4	14	28	26	15	39	22	35
26	19	33	23	31	44	32	18	32	32	44	48	4	0	10	25	24	18	39	19	32
20	18	23	22	20	34	23	8	28	28	45	40	14	10	0	16	18	25	35	8	22
10	19	21	20	13	19	7	13	18	18	41	24	28	25	16	0	8	34	26	10	16
2	13	29	12	21	23	11	18	11	11	33	24	26	24	18	8	0	28	19	15	24
28	16	48	19	44	51	39	33	30	30	31	50	15	18	25	34	28	0	33	32	46
16	20	47	16	39	31	25	37	8	8	18	23	39	39	35	26	19	33	0	34	41
18	21	17	24	12	27	16	3	26	26	46	34	22	19	8	10	15	32	34	0	14
26	34	6	35	3	21	17	14	33	33	56	33	35	32	22	16	24	46	41	14	0
];
num q{i in 2..n}=[4	6	7	4	5	3	6	5	4	6	6	7	3	7	6	2	7	6	5	4
];
var x{i in 1..n,j in 1..n} binary;
var z{i in 2..n}>=q[i] <=Q0;
min koszt=sum{i in 1..n,j in 1..n}c[i,j]*x[i,j];
con do1Miasta{i in 2..n}: sum{j in 1..n}x[i,j]=1;
con z1Miasta{j in 2..n}: sum{i in 1..n}x[i,j]=1;
con magDoMMiast: sum{j in 1..n}x[1,j]=m;
con magZMMiast: sum{i in 1..n}x[i,1]=m;
con ogr: x[1,1]=0;
con bezKrotkichCykli{i in 2..n,j in 2..n}:
z[i]-z[j]+Q0*x[i,j]<=Q0-q[j];
solve with milp / timetype =1 maxtime = 30;
print x z;
quit;
